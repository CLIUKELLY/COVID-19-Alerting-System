<!doctype html>

<html lang="en">

<head>
    <meta charset="utf-8">
    <Title>Requests</Title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/js/bootstrap.bundle.min.js" integrity="sha384-JEW9xMcG8R+pH31jmWH6WWP0WintQrMb4s7ZOdauHnUtxwoG2vI5DkLtS3qm9Ekf" crossorigin="anonymous"></script>
    <script src="js/vue.min.js" type="text/javascript" charset="utf-8"></script>
</head>

<body style="background-color: #e3f2fd;">
    <!------------------------------
                    Banner
        ------------------------------->
    <div class="container-fluid bg-primary">
        <p class="text-center fs-1 fw-bold text-white ">WELCOME TO</p>
        <p class="text-center fs-2 fw-bold text-white ">COVID-19 Public Health Care System</p>
    </div>
</body>
<div id="container">

    <body id="body">

        <!-------------------------------------------------
            Main content section
        --------------------------------------------------->
        <div id="loginForm">
            <div class="form">
                <div class="imgcontainer">
                    <img src="Image/img_userProfile.png" alt="Profile Picture" class="user">
                </div>

                <div class="container">
                    <label for="uname"><b>Username</b></label>
                    <div class="input">
                        <input class="val" value="" id="username" type="text" placeholder="Enter Medicare Card Number" name="uname" required>
                    </div>

                    <label for="psw"><b>Password</b></label>
                    <div class="input">
                        <input class="val" value="" id="password" type="password" placeholder="Enter Password" name="psw" required>
                    </div>

                    <button id="login">Login</button>
                    <label>
                    <input type="checkbox" id="remember" name="remember"> Remember me
                  </label>
                </div>

                <div class="container" style="background-color:#f1f1f1">
                    <button type="button" id="cancel" class="cancelbtn">Cancel</button>
                </div>
            </div>
        </div>

        <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.1/dist/umd/popper.min.js " integrity="sha384-SR1sx49pcuLnqZUnnPwx6FCym0wLsk5JZuNx2bPPENzswTNFaQU1RDvt3wT4gWFG " crossorigin="anonymous "></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/js/bootstrap.min.js " integrity="sha384-j0CNLUeiqtyaRmlzUHCPZ+Gy5fQu0dQ6eZ/xAww941Ai1SxSY+0EQqNXNE6DZiVc " crossorigin="anonymous "></script>
        <script src="js/jquery-3.4.1.min.js" type="text/javascript" charset="utf-8"></script>
        <script>
            var username = $('#username');
            var password = $('#password');

            // Check if localStorage has some data in it
            if (JSON.parse(localStorage.getItem('remember')) == 'checked') {
                $('#remember').attr('checked', 'checked');
                if (JSON.parse(localStorage.getItem('username')) != null) {
                    $('#username').val(JSON.parse(localStorage.getItem('username')));
                }
                if (JSON.parse(localStorage.getItem('password')) != null) {
                    $('#password').val(JSON.parse(localStorage.getItem('password')));
                }
            }

            // Login
            $('#login').click(function() {
                if (username.val() == '') {
                    alert('Enter your Medicare Card Number, please!');
                    return;
                }
                if (password.val() == '') {
                    alert('Enter your password, please!');
                    return;
                }
                $.ajax({
                    url: proBaseUrl + 'user/login',
                    type: 'POST',
                    data: {
                        username: username.val(),
                        password: password.val()
                    },
                    success: (res) => {
                        if (res.code == 0) {
                            if (res.data.user_jobPosition == 'Product Manager') {
                                localStorage.setItem('userManager', JSON.stringify(res.data));
                                window.location.href = 'P2_requests_manager.html';
                            } else if (res.data.user_jobPosition == 'Commercial Business Analyst') {
                                localStorage.setItem('userAnalyst', JSON.stringify(res.data));
                                window.location.href = 'P2_requests_analyst.html';
                            } else {
                                alert('The user does not have permission');
                            }
                        } else {
                            alert(res.msg);
                        }
                    }
                })
            })

            //remember
            $('#remember').click(function(e) {
                    if (username.val() == '') {
                        alert('Enter one user name,please!');
                        e.preventDefault();
                        return;
                    }
                    if (password.val() == '') {
                        alert('Enter one user password,please!');
                        e.preventDefault();
                        return;
                    }
                    // console.log($('#remember').prop('checked'));
                    if ($('#remember').attr('checked') != 'checked') {
                        console.log(1);
                        setStorage();
                    } else {
                        console.log(2);
                        clearStorage();
                    }
                })
                // Save in LocalStrage
            function setStorage() {
                $('#remember').attr('checked', 'checked');
                // console.log($('#remember').prop('checked'));
                localStorage.setItem('username', JSON.stringify($('#username').val()));
                localStorage.setItem('password', JSON.stringify($('#password').val()));
                localStorage.setItem('remember', JSON.stringify('checked'));
            }
            // Remove Local Strage
            function clearStorage() {
                $('#remember').attr('checked', '');
                // console.log($('#remember').prop('checked'));
                localStorage.setItem('username', JSON.stringify($('#username').val('')));
                localStorage.setItem('password', JSON.stringify($('#password').val('')));
                localStorage.setItem('remember', JSON.stringify(''));
            }

            // Cancel
            $('#cancel').click(function() {
                username.val('');
                password.val('');
                clearStorage();
                $('#remember').prop('checked', false);
            })
        </script>
    </body>
</div>



</html>